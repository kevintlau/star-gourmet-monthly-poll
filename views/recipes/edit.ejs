<%- include("../partials/header") %>

<div class="container">
  <form action="/recipes/<%= recipe._id %>?_method=PUT" method="POST">
    <div class="row justify-content-center">
      <div class="col-4">
        <label for="name-input" class="form-label mt-2">Recipe Name:</label>
        <input type="text" class="form-control" 
          name="name" id="name-input" value="<%= recipe.name %>" required 
        />
      </div>
      <!-- show theme of the contest but don't allow user to change it -->
      <div class="col-4">
        <label class="form-label mt-2">Theme:</label>
        <input type="text" class="form-control" 
          name="cuisine" value="<%= recipe.cuisine %>" readonly 
        />
      </div>
    </div>
    <!-- load in the contest ID and name into req.body -->
    <input type="hidden" name="contest" value="<%= recipe.contestId %>" />
    <input type="hidden" name="contestName" value="<%= recipe.contestName %>" />
    <div class="row justify-content-center">
      <div class="col-4">
        <label for="image-input" class="form-label mt-2">Image Link:</label>
        <input type="url" class="form-control" 
          name="image" id="image-input" value="<%= recipe.image %>" required /> 
      </div>
      <div class="col-4">
        <label for="type-input" class="form-label mt-2">Type:</label>
        <select class="form-select" name="type" id="type-input" required>
          <option 
            value="Breakfast"
            <%- (recipe.type === "Breakfast" ? "selected" : "") %>
          >
            Breakfast
          </option>
          <option
            value="Smallplate"
            <%- (recipe.type === "Smallplate" ? "selected" : "") %>
          >
            Smallplate
          </option>
          <option
            value="Snack"
            <%- (recipe.type === "Snack" ? "selected" : "") %>
          >
            Snack
          </option>
          <option
            value="Appetizer"
            <%- (recipe.type === "Appetizer" ? "selected" : "") %>
          >
            Appetizer
          </option>
          <option
            value="Entree"
            <%- (recipe.type === "Entree" ? "selected" : "") %>
          >
            Entree
          </option>
          <option
            value="Side"
            <%- (recipe.type === "Side" ? "selected" : "") %>
          >
            Side
          </option>
          <option
            value="Dessert"
            <%- (recipe.type === "Dessert" ? "selected" : "") %>
          >
            Dessert
          </option>
          <option
            value="Beverage"
            <%- (recipe.type === "Beverage" ? "selected" : "") %>
          >
            Beverage
          </option>
        </select>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-4">
        <label for="ing1-input" class="form-label mt-2">Ingredient 1 (required):</label>
        <select class="form-select" name="ing1" id="ing1-input" required>
          <option value="" selected disabled hidden>Select Ingredient 1</option>
          <% for (category in ingredients) { %>
            <optgroup label="<%= category %>">
            <% ingredients[category].forEach(ing => { %>
              <option 
                value="<%= ing %>" 
                <%- recipe.ingredients[0] === ing ? "selected" : "" %>
              >
                <%= ing %>
              </option>
            <% }); %>
          <% } %>
        </select>
      </div>
      <div class="col-4">
        <label for="ing2-input" class="form-label mt-2">Ingredient 2 (required):</label>
        <select class="form-select" name="ing2" id="ing2-input" required>
          <option value="" selected disabled hidden>Select Ingredient 2</option>
          <% for (category in ingredients) { %>
            <optgroup label="<%= category %>">
            <% ingredients[category].forEach(ing => { %>
              <option 
                value="<%= ing %>" 
                <%- recipe.ingredients[1] === ing ? "selected" : "" %>
              >
                <%= ing %>
              </option>
            <% }); %>
          <% } %>
        </select>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-4">
        <label for="ing3-input" class="form-label mt-2">Ingredient 3:</label>
        <select class="form-select" name="ing3" id="ing3-input">
          <option value="" selected disabled hidden>Select Ingredient 3</option>
          <% for (category in ingredients) { %>
            <optgroup label="<%= category %>">
            <% ingredients[category].forEach(ing => { %>
              <option 
                value="<%= ing %>" 
                <%- recipe.ingredients[2] === ing ? "selected" : "" %>
              >
                <%= ing %>
              </option>
            <% }); %>
          <% } %>
        </select>
      </div>
      <div class="col-4">
        <label for="ing4-input" class="form-label mt-2">Ingredient 4:</label>
        <select class="form-select" name="ing4" id="ing4-input">
          <option value="" selected disabled hidden>Select Ingredient 4</option>
          <% for (category in ingredients) { %>
            <optgroup label="<%= category %>">
            <% ingredients[category].forEach(ing => { %>
              <option 
                value="<%= ing %>" 
                <%- recipe.ingredients[3] === ing ? "selected" : "" %>
              >
                <%= ing %>
              </option>
            <% }); %>
          <% } %>
        </select>
      </div>
    </div>
    <div class="row text-center">
      <h5 class="mt-2">Current Score: <%= recipe.score %></h5>
    </div>
    <div class="row text-center">
      <div>
        <button type="submit" class="btn btn-success">
          Update Recipe
        </button>
      </div>
    </div>
  </form>
</div>

<%- include("../partials/footer") %>
